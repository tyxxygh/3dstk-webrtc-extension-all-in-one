.\"
.\"                           TERMS AND CONDITIONS
.\"                                   FOR
.\"                         OPEN SOURCE CODE LICENSE
.\"                               Version 1.1
.\" 
.\" Japan Registry Services Co., Ltd. ("JPRS"), a Japanese corporation
.\" having its head office at Chiyoda First Bldg. East 13F 3-8-1 Nishi-Kanda,
.\" Chiyoda-ku, Tokyo 101-0065, Japan, grants you the license for open source
.\" code specified in EXHIBIT A the "Code" subject to the following Terms and
.\" Conditions ("OSCL").
.\" 
.\" 1. License Grant.
.\"   JPRS hereby grants you a worldwide, royalty-free, non-exclusive
.\"   license, subject to third party intellectual property claims:
.\"   (a) under intellectual property rights (other than patent or
.\"       trademark) licensable by JPRS to use, reproduce, modify, display,
.\"       perform, sublicense and distribute the Code (or portions thereof)
.\"       with or without modifications, and/or as part of a derivative work;
.\"       or
.\"   (b) under claims of the infringement through the making, using,
.\"       offering to sell and/or otherwise disposing the JPRS Revised Code
.\"       (or portions thereof);
.\"   (c) the licenses granted in this Section 1(a) and (b) are effective on
.\"       the date JPRS first distributes the Code to you under the terms of
.\"       this OSCL;
.\"   (d) Notwithstanding the above stated terms, no patent license is
.\"       granted:
.\"       1)  for a code that you delete from the Code;
.\"       2)  separate from the Code; or
.\"       3)  for infringements caused by:
.\"            i) modification of the Code; or
.\"           ii) combination of the Code with other software or devices.
.\" 
.\" 2. Consents.
.\"   You agree that:
.\"   (a) you must include a copy of this OSCL and the notice set forth in
.\"       EXHIBIT A with every copy of the Code you distribute;
.\"   (b) you must include a copy of this OSCL and the notice set forth in
.\"       EXHIBIT A with every copy of binary form of the Code in the
.\"       documentation and/or other materials provided with the distribution;
.\"   (c) you may not offer or impose any terms on any source code version
.\"       that alters or restricts the applicable version of this OSCL or
.\"       the recipients' rights hereunder.
.\"   (d) If the terms and conditions are set forth in EXHIBIT A, you must
.\"       comply with those terms and conditions.
.\" 
.\" 3. Proprietary Information.
.\"   All trademarks, service marks, patents, copyrights, trade secrets, and
.\"   other proprietary rights in or related to the Code are and will remain
.\"   the exclusive property of JPRS or its licensors, whether or not
.\"   specifically recognized or perfected under local law except specified
.\"   in this OSCL; provided however you agree and understand that the JPRS
.\"   name may not be used to endorse or promote this Code without prior
.\"   written approval of JPRS.
.\" 
.\" 4. WARRANTY DISCLAIMER.
.\"   JPRS MAKES NO REPRESENTATIONS AND WARRANTIES REGARDING THE USE OF THE
.\"   CODE, NOR DOES JPRS MAKE ANY REPRESENTATIONS THAT THE CODE WILL BECOME
.\"   COMMERCIALLY AVAILABLE. JPRS, ITS AFFILIATES, AND ITS SUPPLIERS DO NOT
.\"   WARRANT OR REPRESENT THAT THE CODE IS FREE OF ERRORS OR THAT THE CODE
.\"   IS SUITABLE FOR TRANSLATION AND/OR LOCALIZATION. THE CODE IS PROVIDED
.\"   ON AN "AS IS" BASIS AND JPRS AND ITS SUPPLIERS HAVE NO OBLIGATION TO
.\"   CORRECT ERRORS OR TO SUPPORT THE CODE UNDER THIS OSCL FOR ANY REASON.
.\"   TO THE FULL EXTENT PERMITTED BY LAW, ALL OBLIGATIONS ARE HEREBY
.\"   EXCLUDED WHETHER EXPRESS, STATUTORY OR IMPLIED UNDER LAW, COURSE OF
.\"   DEALING, CUSTOM, TRADE USAGE, ORAL OR WRITTEN STATEMENT OR OTHERWISE,
.\"   INCLUDING BUT NOT LIMITED TO ANY IMPLIED WARRANTIES OF MERCHANTABILITY
.\"   OR FITNESS FOR A PARTICULAR PURPOSE CONCERNING THE CODE.
.\" 
.\" 5. NO LIABILITY.
.\"   UNDER NO CIRCUMSTANCES SHALL JPRS AND/OR ITS AFFILIATES, LICENSORS, OR
.\"   REPRESENTATIVES BE LIABLE FOR ANY DAMAGES INCLUDING BUT NOT LIMITED TO
.\"   CONSEQUENTIAL, INDIRECT, SPECIAL, PUNITIVE OR INCIDENTAL DAMAGES,
.\"   WHETHER FORESEEABLE OR UNFORESEEABLE, BASED ON YOUR CLAIMS, INCLUDING,
.\"   BUT NOT LIMITED TO, CLAIMS FOR LOSS OF DATA, GOODWILL, PROFITS, USE OF
.\"   MONEY, INTERRUPTION IN USE OR AVAILABILITY OF DATA, STOPPAGE, IMPLIED
.\"   WARRANTY, BREACH OF CONTRACT, MISREPRESENTATION, NEGLIGENCE, STRICT
.\"   LIABILITY IN TORT, OR OTHERWISE.
.\" 
.\" 6. Indemnification.
.\"   You hereby agree to indemnify, defend, and hold harmless JPRS for any
.\"   liability incurred by JRPS due to your terms of warranty, support,
.\"   indemnity, or liability offered by you to any third party.
.\" 
.\" 7. Termination.
.\" 7.1 This OSCL shall be automatically terminated in the events that:
.\"   (a) You fail to comply with the terms herein and fail to cure such
.\"       breach within 30 days of becoming aware of the breach;
.\"   (b) You initiate patent or copyright infringement litigation against
.\"       any party (including a cross-claim or counterclaim in a lawsuit)
.\"       alleging that the Code constitutes a direct or indirect patent or
.\"       copyright infringement, in such case, this OSCL to you shall
.\"       terminate as of the date such litigation is filed;
.\" 7.2 In the event of termination under Sections 7.1(a) or 7.1(b) above,
.\"     all end user license agreements (excluding distributors and
.\"     resellers) which have been validly granted by You or any distributor
.\"     hereunder prior to termination shall survive termination.
.\"
.\" 
.\" 8. General.
.\"   This OSCL shall be governed by, and construed and enforced in
.\"   accordance with, the laws of Japan. Any litigation or arbitration
.\"   between the parties shall be conducted exclusively in Tokyo, Japan
.\"   except written consent of JPRS provides other venue.
.\" 
.\" 
.\"                                EXHIBIT A
.\" 
.\" The original open source code of idnkit-2 is idnkit-1.0 developed and
.\" conceived by Japan Network Information Center ("JPNIC"), a Japanese
.\" association, Kokusai-Kougyou-Kanda Bldg 6F, 2-3-4 Uchi-Kanda,
.\" Chiyoda-ku, Tokyo 101-0047, Japan, and JPRS modifies above original code
.\" under following Terms and Conditions set forth by JPNIC.
.\" 
.\"                                  JPNIC
.\" 
.\" Copyright (c) 2000-2002 Japan Network Information Center.  All rights reserved.
.\" 
.\" By using this file, you agree to the terms and conditions set forth bellow.
.\" 
.\"                       LICENSE TERMS AND CONDITIONS
.\" 
.\" The following License Terms and Conditions apply, unless a different
.\" license is obtained from Japan Network Information Center ("JPNIC"),
.\" a Japanese association, Kokusai-Kougyou-Kanda Bldg 6F, 2-3-4 Uchi-Kanda,
.\" Chiyoda-ku, Tokyo 101-0047, Japan.
.\" 
.\" 1. Use, Modification and Redistribution (including distribution of any
.\"    modified or derived work) in source and/or binary forms is permitted
.\"    under this License Terms and Conditions.
.\" 
.\" 2. Redistribution of source code must retain the copyright notices as they
.\"    appear in each source code file, this License Terms and Conditions.
.\" 
.\" 3. Redistribution in binary form must reproduce the Copyright Notice,
.\"    this License Terms and Conditions, in the documentation and/or other
.\"    materials provided with the distribution. For the purposes of binary
.\"    distribution the "Copyright Notice" refers to the following language:
.\"    "Copyright (c) 2000-2002 Japan Network Information Center.  All rights reserved."
.\" 
.\" 4. The name of JPNIC may not be used to endorse or promote products
.\"    derived from this Software without specific prior written approval of
.\"    JPNIC.
.\" 
.\" 5. Disclaimer/Limitation of Liability: THIS SOFTWARE IS PROVIDED BY JPNIC
.\"    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
.\"    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
.\"    PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL JPNIC BE LIABLE
.\"    FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
.\"    CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
.\"    SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
.\"    BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
.\"    WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
.\"    OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
.\"    ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
.\" 
.\" 
.\"                        JPRS Public License Notice
.\"                                   For
.\"                                idnkit-2.
.\" 
.\" The contents of this file are subject to the Terms and Conditions for
.\" the Open Source Code License (the "OSCL"). You may not use this file
.\" except in compliance with above terms and conditions. A copy of the OSCL
.\" is available at <http://jprs.co.jp/idn/>.
.\" The JPRS Revised Code is idnkit-2.
.\" The Initial Developer of the JPRS Revised Code is Japan Network
.\" Information Center ("JPNIC"), a Japanese association,
.\" Kokusai-Kougyou-Kanda Bldg 6F, 2-3-4 Uchi-Kanda, Chiyoda-ku, Tokyo
.\" 101-0047, Japan.
.\" "Copyright (c) 2000-2002 Japan Network Information Center.  All rights reserved."
.\" "Copyright (c) 2010-2012 Japan Registry Services Co., Ltd.  All rights reserved."
.\" Contributor(s): ______________________________________.
.\" 
.\" If you wish to allow use of your version of this file only under the
.\" above License(s) and not to allow others to use your version of this
.\" file, please indicate your decision by deleting the relevant provisions
.\" above and replacing them with the notice and other provisions required
.\" by the above License(s). If you do not delete the relevant provisions,
.\" a recipient may use your version of this file under either the above
.\" License(s).
.\"
.TH idnconv2 1 "Sep 21, 2012"
.\"
.SH NAME
idnconv2 \- internationalized domain name converter
.\"
.SH SYNOPSIS
\fBidnconv2\fR [\fIoptions..\fP] [\fIfile\fP...]
.\"
.SH DESCRIPTION
\fBidnconv2\fR command is an internationalized domain name converter.
idnconv2, which is provided as a part of idnkit version 2, supports
IDNA2008 only. For IDNA2003, use \fIidnconv\fP in idnkit version 1.
.PP
idnconv2 reads text data, converts internationalized domain names in
the text, and outputs the converted text to standard out.
If a file name is specified, idnconv2 reads the text data from the
file. Otherwise, idnconv2 reads data from standard in.
.PP
By default, idnconv2 encodes domain names (i.e. conversion from U-labels
to A-labels). Specifying \-reverse (or \-r) option, it decodes domain
names (i.e. conversion from A-labels to U-labels).
.PP
Unless \-noconf (or \-C) option is given, idnconv2 reads a configuration
file (\fI@sysconfdir@/idn2.conf\fP, \fI~/.idn2rc\fP or a file specified
by an option) and performs conversions according to the parameters
specified in the file.
.PP
idnconv2 can convert configuration files and zone master files for
ISC BIND. See ``FILE MANAGEMENT'' for details.
.\"
.SH OPTIONS
.TP 4
\fB\-in\fP \fIin-code\fP, \fB\-i\fP \fIin-code\fP
Specify the encoding name of the input text.
Any of the following encoding names can be recognized.
.RS 4
.IP "\(bu" 2
Any encoding names which \fIiconv_open()\fP accepts
.IP "\(bu" 2
\f(CWPunycode\fR
.IP "\(bu" 2
\f(CWUTF-8\fR
.IP "\(bu" 2
Any alias names for the above, defined by the encoding alias file.
.RE
.IP "" 4
In encoder mode, the encoding defaults to the value of the environment
variable ``\fBIDN_LOCAL_CODESET\fR'' or, if it is not set, an encoding
determined from the locale information.
In decoder mode, the encoding defaults to ``Punycode''.
.TP 4
\fB\-out\fP \fIout-code\fP, \fB\-o\fP \fIout-code\fP
Specify the encoding name of the output text. \fIout-code\fP can be any
encoding name that can be specified for \fB\-in\fR option.
.IP "" 4
In encoder mode, the encoding defaults to ``Punycode''.
In decoder mode, it defaults to the value of the environment variable
``\fBIDN_LOCAL_CODESET\fR'' or, if it is not set, an encoding determined
from the locale information.
.TP 4
\fB\-conf\fP \fIfile\fP, \fB\-c\fP \fIfile\fP
Specify the path of idnkit configuration file.
If not specified, the default path (@sysconfdir@/idn2.conf or ~/.idn2rc)
is used, unless \-noconf (or \-C) option is specified.
.TP 4
\fB\-noconf\fP, \fB\-C\fP
Suppress reading a configuration file.
.TP 4
\fB\-reverse\fP, \fB\-r\fP
Specify decoder mode.
idnconv2 runs in encoder mode, by default.
.TP 4
\fB\-registration\fP, \fB\-g\fP (default)
Use domain name registration protocol.
This is the default behavior.
.TP 4
\fB\-lookup\fP, \fB\-l\fP
Use domain name lookup protocol.
.TP 4
\fB\-nomap\fP, \fB\-M\fP
Don't perform the ``map'' action.
This is the same as ``-skip map''.
.TP 4
\fB\-skip\fP \fIaction,...\fP
Skip \fIactions\fP. the following action names are recognized:
.RS 4
.IP \fImap\fP
mappings
.IP \fIasclower\fP
convert ASCII uppercase letters to lowercase
.IP \fIrtconv\fP
conversion from Punycode to Unicode for round trip check
.IP \fIprohcheck\fP
prohibited code point check
.IP \fIunascheck\fP
unassigned code point check
.IP \fInfccheck\fP
NFC conformance check
.IP \fIprefcheck\fP
ACE prefix check
.IP \fIhyphcheck\fP
hyphen check
.IP \fIcombcheck\fP
combining character check
.IP \fIctxjcheck\fP
CONTEXTJ code point check
.IP \fIctxocheck\fP
CONTEXTO code point check for domain name registration protocol.
.IP \fIctxolitecheck\fP
CONTEXTO code point check for domain name lookup protocol.
.IP \fIbidicheck\fP
Bidi check.
.IP \fIidnconv\fP
conversion to Punycode in encoder mode
(conversion from Punycode in decoder mode)
.IP \fIlencheck\fP
label length check
.IP \fIrtcheck\fP
round trip check
.RE
.TP 4
\fB\-whole\fP, \fB\-w\fP
Assumes each input line represents an internationalized domain name.
If this option is not specified, only non-ASCII characters and their
surrounding texts will be converted.
See ``ENCODER MODE'' and ``DECODER MODE'' for details.
.TP 4
\fB\-localcheck\fP \fIfile\fP, \fB\-e\fP \fIfile\fP
Also perform local code point check using \fIfile\fP.
IDN registries define their own code point tables allowed for domain
name registration.
Using the local check feature, you can check whether a domain name
consists of code points allowed by a particular registry.
The format of \fIfile\fP is explained in idn_setlocalcheckfile(3).
.TP 4
\fB\-flush\fP
Force line-buffering mode.
.TP 4
\fB\-test\fP, \fB\-t\fP
Print which language, input encoding and output encoding will be chosen,
if the same arguments are gievn to the command, and then quit immediately.
.TP 4
\fB\-version\fP, \fB\-v\fP
Print version information and quit.
.TP 4
\fB\-help\fP, \fB\-h\fP
Print help and quit.
.\"
.SH LOCAL ENCODING
idnconv2 guesses local encoding from locale and environment variables.
See the ``LOCAL ENCODING'' section in idn2.conf(5) for more details.
.\"
.SH ENCODER MODE
idnconv2 performs conversion line by line.
Here describes how idnconv2 does its job for each line.
.\"
.IP "1. read a line from input text" 4
.IP "2. convert the line to UTF-8" 4
idnconv2 converts the line from local encoding to UTF-8.
.IP "3. find internationalized domain names" 4
If the \-whole\ (or \-w) option is specified, the entire line except
for a new line character is assumed as an internationalized domain name.
Otherwise, idnconv2 recognizes any character sequences having
the following properties in the line as internationalized domain names.
.RS 4
.IP "\(bu" 2
containing at least one non-ASCII character, and
.IP "\(bu" 2
consisting of legal domain name characters (alphabets, digits, hyphens),
non-ASCII characters and period.
.RE
.IP "4. convert internationalized domain names" 4
For each internationalized domain name found in the line,
\fBidnconv2\fR converts the names to A-labels by applying the domain
name registration or lookup protocol defined by IDNA2008-Protocol.
.IP "5. output the result" 4
.PP
.\"
.SH DECODER MODE
This is like the encoder mode, but they are not symmetric. idnconv2
does its job for each line.
.\"
.IP "1. read a line from input text" 4
.IP "2. convert the line to UTF-8" 4
idnconv2 converts the line from local encoding to UTF-8.
.IP "3. find internationalized domain names" 4
If the \-whole\ (or \-w) option is specified, the entire line except
for a new line character is assumed as an internationalized domain name.
Otherwise, idnconv2 decodes any valid ASCII domain names
including ACE names in the line.
.IP "4. convert domain names to the local encoding"
For each internationalized domain name found in the line,
\fBidnconv2\fR converts the names to U-labels by applying the domain
name registration or lookup protocol defined by IDNA2008-Protocol.
.IP "5. output the result" 4
.PP
.\"
.SH FILE MANAGEMENT
Maybe the best way to manage named.conf or zone master files for ISC BIND
that contains internationalized domain name is to keep them in your local
encoding so that they can be edited with your favorite editor, and generate
named.conf and master files of Punycode edition using \fBidnconv2\fP.
.PP
.RS 4
.nf
.ft CW
idnconv2 -in UTF-8 named.conf.utf8 > named.conf
idnconv2 -in UTF-8 example.com.zone.utf8 > example.com.zone
.RE
.\"
.SH SEE ALSO
idncheck(1),
idncmp(1),
iconv(3),
idn2.conf(5),
idnalias.conf(5),
idnlang.conf(5)
.\"
.SH BUGS
The automatic input-code selection depends on your system, and sometimes
it cannot guess or guess wrong.  It is better to explicitly specify it
using \-in option.
